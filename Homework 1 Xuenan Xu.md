# Homework 1

##### by Xuenan Xu GWID G26980825
&nbsp;

**Problem 1**

1) Addictive Inverse

|   | A | B | C | D | E | F | G | H | I | J | K | L | M | N | O | P | Q | R | S | T | U | V | W | X | Y | Z
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---
| A | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25
| B | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0
| C | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1
| D | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2
| E | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3
| F | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4
| G | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5
| H | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6
| I | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7
| J | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8
| K | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9
| L | 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10
| M | 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11
| N | 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12
| O | 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13
| P | 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14
| Q | 16| 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15
| R | 17| 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16
| S | 18| 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17
| T | 19| 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18
| U | 20| 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19
| V | 21| 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20
| W | 22| 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21
| X | 23| 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22
| Y | 24| 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23
| Z | 25| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24

2) Multiplicative Inverse

|   | A | B | C | D | E | F | G | H | I | J | K | L | M | N | O | P | Q | R | S | T | U | V | W | X | Y | Z
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---
| A | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0
| B | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10| 11| 12| 13| 14| 15| 16| 17| 18| 19| 20| 21| 22| 23| 24| 25
| C | 0 | 2 | 4 | 6 | 8 | 10| 12| 14| 16| 18| 20| 22| 24| 0 | 2 | 4 | 6 | 8 | 10| 12| 14| 16| 18| 20| 22| 24
| D | 0 | 3 | 6 | 9 | 12| 15| 18| 21| 24| 1 | 4 | 7 | 10| 13| 16| 19| 22| 25| 2 | 5 | 8 | 11| 14| 17| 20| 23
| E | 0 | 4 | 8 | 12| 16| 20| 24| 2 | 6 | 10| 14| 18| 22| 0 | 4 | 8 | 12| 16| 20| 24| 2 | 6 | 10| 14| 18| 22
| F | 0 | 5 | 10| 15| 20| 25| 4 | 9 | 14| 19| 24| 3 | 8 | 13| 18| 23| 2 | 7 | 12| 17| 22| 1 | 6 | 11| 16| 21
| G | 0 | 6 | 12| 18| 24| 4 | 10| 16| 22| 2 | 8 | 14| 20| 0 | 6 | 12| 18| 24| 4 | 10| 16| 22| 2 | 8 | 14| 20
| H | 0 | 7 | 14| 21| 2 | 9 | 16| 23| 4 | 11| 18| 25| 6 | 13| 20| 1 | 8 | 15| 22| 3 | 10| 17| 24| 5 | 12| 19
| I | 0 | 8 | 16| 24| 6 | 14| 22| 4 | 12| 20| 2 | 10| 18| 0 | 8 | 16| 24| 6 | 14| 22| 4 | 12| 20| 2 | 10| 18
| J | 0 | 9 | 18| 1 | 10| 19| 2 | 11| 20| 3 | 12| 21| 4 | 13| 22| 5 | 14| 23| 6 | 15| 24| 7 | 16| 25| 8 | 17
| K | 0 | 10| 20| 4 | 14| 24| 8 | 18| 2 | 12| 22| 6 | 16| 0 | 10| 20| 4 | 14| 24| 8 | 18| 2 | 12| 22| 6 | 16
| L | 0 | 11| 22| 7 | 18| 3 | 14| 25| 10| 21| 6 | 17| 2 | 13| 24| 9 | 20| 5 | 16| 1 | 12| 23| 8 | 19| 4 | 15
| M | 0 | 12| 24| 10| 22| 8 | 20| 6 | 18| 4 | 16| 2 | 14| 0 | 12| 24| 10| 22| 8 | 20| 6 | 18| 4 | 16| 2 | 14
| N | 0 | 13| 0 | 13| 0 | 13| 0 | 13| 0 | 13| 0 | 13| 0 | 13| 0 | 13| 0 | 13| 0 | 13| 0 | 13| 0 | 13| 0 | 13
| O | 0 | 14| 2 | 16| 4 | 18| 6 | 20| 8 | 22| 10| 24| 12| 0 | 14| 2 | 16| 4 | 18| 6 | 20| 8 | 22| 10| 24| 12
| P | 0 | 15| 4 | 19| 8 | 23| 12| 1 | 16| 5 | 20| 9 | 24| 13| 2 | 17| 6 | 21| 10| 25| 14| 3 | 18| 7 | 22| 11
| Q | 0 | 16| 32| 22| 12| 2 | 18| 8 | 24| 14| 4 | 20| 10| 0 | 16| 32| 22| 12| 2 | 18| 8 | 24| 14| 4 | 20| 10
| R | 0 | 17| 8 | 25| 16| 7 | 24| 15| 6 | 23| 14| 5 | 22| 13| 4 | 21| 12| 3 | 20| 11| 2 | 19| 10| 1 | 18| 9
| S | 0 | 18| 10| 2 | 20| 12| 4 | 22| 14| 6 | 24| 16| 8 | 0 | 18| 10| 2 | 20| 12| 4 | 22| 14| 6 | 24| 16| 8
| T | 0 | 19| 12| 5 | 24| 17| 10| 3 | 22| 15| 8 | 1 | 20| 13| 6 | 25| 18| 11| 4 | 23| 16| 9 | 2 | 21| 14| 7
| U | 0 | 20| 14| 8 | 2 | 22| 16| 10| 4 | 24| 18| 12| 6 | 0 | 20| 14| 8 | 2 | 22| 16| 10| 4 | 24| 18| 12| 6
| V | 0 | 21| 16| 11| 6 | 1 | 22| 17| 12| 7 | 2 | 23| 18| 13| 8 | 3 | 24| 19| 14| 9 | 4 | 25| 20| 15| 10| 5
| W | 0 | 22| 18| 14| 10| 6 | 2 | 24| 20| 16| 12| 8 | 4 | 0 | 22| 18| 14| 10| 6 | 2 | 24| 20| 16| 12| 8 | 4
| X | 0 | 23| 20| 17| 14| 11| 8 | 5 | 2 | 25| 22| 19| 16| 13| 10| 7 | 4 | 1 | 24| 21| 18| 15| 12| 9 | 6 | 3
| Y | 0 | 24| 22| 20| 18| 16| 14| 12| 10| 8 | 8 | 4 | 2 | 0 | 24| 22| 20| 18| 16| 14| 12| 10| 8 | 8 | 4 | 2
| Z | 0 | 25| 24| 23| 22| 21| 20| 19| 18| 17| 16| 15| 14| 13| 12| 11| 10| 9 | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1

**Problem 2**

1) Generate the frequency table for the sentence as names perhaps contains strange patterns that will distract our decrypting process

| A | C | D | F | G | I | J | L | M | O | P | Q | R | T | U | V | W | X | Y | Z
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---
| 7 | 5 | 5 | 4 | 6 | 3 | 4 | 7 | 1 | 1 | 3 | 1 | 3 | 1 | 6 | 11| 1 | 8 | 2 | 1

2) As discovered from the frequency table, `V`, `L`, `A` and `X` have very high frequency, then I find that the pattern `VL` appeared 5 times and all of them seems to be the start of a word, so I guess they are `TH`. After filled them into the sentence, I believe that, according to the word `VLG`, `VLXV` and `VA`, `G` shall be `E`, `X` shall be `A` and `A` shall be `O` to form `THE`, `THAT` and `TO`.

| A | C | D | F | G | I | J | L | M | O | P | Q | R | T | U | V | W | X | Y | Z
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---
| O |   |   |   | E |   |   | H |   |   |   |   |   |   |   | T |   | A |   |

3) Then I noticed the word `VLXJ` which looks like `THA*` on my paper, but the `*` cannot be `T`, so after I tried with the rest 25 characters, I believe that `J` refers to `N` to form `THAN`. There is another word `XIACV` which is like `A*O*T`, and the first thing comes to my mind is `ABOUT`.

| A | C | D | F | G | I | J | L | M | O | P | Q | R | T | U | V | W | X | Y | Z
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---
| O | U |   |   | E | B | N | H |   |   |   |   |   |   |   | T |   | A |   |

4) At the middle of the sentence there is two words `LXIUVD XFG` which looks like `HAB*T* A*E`. I think that the second word is `ARE` and according to that, the last character of the first word has a great probability of being `S`, so the perfect match for these two words is `HABITS ARE`.

| A | C | D | F | G | I | J | L | M | O | P | Q | R | T | U | V | W | X | Y | Z
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---
| O | U | S | R | E | B | N | H |   |   |   |   |   |   | I | T |   | A |   |

5) According to the rear part of the sentence `RAAP ...... AGJD`, we can see a compare between habits -- `*OO* HABITS ARE SO *U*H EASIER TO *I*E U* THAN BA* ONES`, which shows that `*OO*` and `BA*` are opposite words, so I think they are `GOOD` and `BAD`. By the way, the word between `SO` and `EASIER` can easily be filled out to be `MUCH`.

| A | C | D | F | G | I | J | L | M | O | P | Q | R | T | U | V | W | X | Y | Z
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---
| O | U | S | R | E | B | N | H |   | M | D |   | G |   | I | T |   | A | C |

6) The longest word `CJMAFYVCJXVG` looks like `UN*ORCTUNATE` now, but I cannot figure out any other word than `UNFORTUNATE` so I believe the `Y` which appears to be `C` is redundant. The two words `RUZG CW` seems like `GI*E U*` and I'd like to fill them with `GIVE UP`.

| A | C | D | F | G | I | J | L | M | O | P | Q | R | T | U | V | W | X | Y | Z
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---
| O | U | S | R | E | B | N | H | F | M | D |   | G |   | I | T | P | A | C | V

7) The last word left is `QAFTP` and it looks like `*OR*D`, I don't know any other word except `WORLD`, there are minor other possibilities but I think `WORLD` fits this sentence perfectly. Now the assignment table is complete.

| A | C | D | F | G | I | J | L | M | O | P | Q | R | T | U | V | W | X | Y | Z
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---
| O | U | S | R | E | B | N | H | F | M | D | W | G | L | I | T | P | A | C | V

## _Note that I'm quite a lazy guy so I'd prefer use computer program to solve a bunch of simple math problems for me, the understanding of the cipher/decipher process is in the program. Problem 3 and 4 are written in Java._

**Problem 3**

a)
```java
// Permutation Cipher
private static void permutationCipher(String text, Integer[] pattern) {
    // Build the new sting
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < text.length() / pattern.length; i++) {
        for (int j : pattern) {
            int offset = i * pattern.length + j - 1;
            if (offset < text.length())
                sb.append(text.charAt(offset));
        }
    }
    System.out.println(sb.toString());
}
```
And the ciphered text is:
```
OILESVHNTOLEMIYDCENOIFREBKAOERHRNATE
```

b)
```java
// Assignment Generator
private static HashMap<Integer, Integer> assignment(int a, int b) {
    HashMap<Integer, Integer> hashMap = new HashMap<>();
    for (int i = 0; i < 26; i++)
        // Stimulate the cipher process
        hashMap.put(i, (a * i + b) % 26);
    return hashMap;
}
```

```java
// Affine Cipher
private static void affineCipher(String text, int a, int b) {
    // Get the assignment table
    HashMap<Integer, Integer> assignment = assignment(a, b);
    for (int i = 0; i < text.length(); i++)
        // Output the correspond value of each character
        System.out.print((char) (assignment.get(text.charAt(i) - 'A') + 'A'));
    System.out.println();
}
```

And the ciphered text is:
```
DYVG IA HBG YRDQ KGZISIRG NYT E LTYWGR BGETH
```

c)
```java
// Vigenere Cipher
private static void vigenereCipher(String text, String key) {
    int keyLength = key.length();
    int[] equivalent = new int[keyLength];
    // Generate the numeric equivalence to ease the following calculation
    for (int i = 0; i < key.length(); i++)
        equivalent[i] = key.charAt(i) - 'A';
    for (int i = 0; i < text.length(); i++) {
        int original = text.charAt(i) - 'A';
        int ciphered = (original + equivalent[i % keyLength]) % 26;
        System.out.print((char) (ciphered + 'A'));
    }
    System.out.println();
}
```

And the ciphered text is:
```
FGZX PA LRI MHDC FLLAMMLY XSK H JJYOCH ZITYB
```

**Problem 4**

After studying the mechanism of affine cipher, I realized that for a specific key set size (26 in this case) and given `b`, the set of `a` is consists of those numbers that are smaller than and relatively prime to the size of key set. So I listed all possible `a`s and let the program to automatically try out all possible solutions for me (with the assignment generater used in 3.b).

```java
// Decipher
private static void affineDecipher(String code) {
    // List all possible 'a'
    int[] aSet = {1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25};
    // Apply the assignments on the code
    for (int a : aSet) {
        System.out.print(a + " : ");
        HashMap<Integer, Integer> assignment = assignment(a, 8);
        for (int i = 0; i < code.length(); i++)
            for (Integer key : assignment.keySet())
                // If value matches, output the key
                if (assignment.get(key) == code.charAt(i) - 'A')
                    System.out.print((char) (key + 'A'));
        System.out.println();
    }
}
```

After running the program, I got the following output:
```
1 : SXIFPANAVIGUGWTPLKATTUNKSUFLKXSANJKOYUPKUNPKXKGPUNC
3 : GZUTFANAHUCYCQPFVMAPPYNMGYTVMZGANDMWIYFMYNFMZMCFYNS
5 : OPMBDANAZMWEWUJDXCAJJENCOEBXCPOANHCIKEDCENDCPCWDENQ
7 : KHQXRANADQMOMSZRJUAZZONUKOXJUHKANFUCWORUONRUHUMRONE
9 : CRYPTANALYSISOFTHEAFFINECIPHERCANBEQUITEINTERESTING
11 : EVWRZANAJWKQKCXZBIAXXQNIEQRBIVEANPIGOQZIQNZIVIKZQNM
15 : WFEJBANAREQKQYDBZSADDKNSWKJZSFWANLSUMKBSKNBSFSQBKNO
17 : YJCLHANAPCISIMVHTWAVVSNWYSLTWJYANZWKGSHWSNHWJWIHSNU
19 : QTKDJANAXKOMOIBJRGABBMNGQMDRGTQANVGYEMJGMNJGTGOJMNW
21 : MLOZXANABOEWEGRXDYARRWNYMWZDYLMANTYSQWXYWNXYLYEXWNK
23 : UBGHVANATGYCYKLVFOALLCNOUCHFOBUANXOESCVOCNVOBOYVCNI
25 : IDSVLANAFSUGUEHLPQAHHGNQIGVPQDIANRQMCGLQGNLQDQULGNY
```
The result makes sense only when `a = 9`, so the original string is:
```
CRYPTANALYSIS OF THE AFFINE CIPHER CAN BE QUITE INTERESTING
```
